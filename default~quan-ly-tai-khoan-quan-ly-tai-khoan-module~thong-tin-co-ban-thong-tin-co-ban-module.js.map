{"version":3,"sources":["./src/app/shared/models/user.model.ts","./src/app/shared/pages/doi-mat-khau/doi-mat-khau.service.ts","./src/app/shared/pages/doi-mat-khau/doi-mat-khau.component.ts","./src/app/shared/pages/doi-mat-khau/doi-mat-khau.component.html"],"names":[],"mappings":"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","file":"default~quan-ly-tai-khoan-quan-ly-tai-khoan-module~thong-tin-co-ban-thong-tin-co-ban-module.js","sourcesContent":["export class UserModel {\r\n    UserId: string\r\n    Username: string\r\n    DisplayName: string\r\n    Status: string\r\n    LockDate: string\r\n    RoleId: string\r\n    RoleName: string\r\n    Email: string\r\n    Avatar: string\r\n    Birthday: string\r\n    Password: string\r\n    PasswordConfirm: string\r\n    PhoneNumber: string\r\n    constructor(username: string, password: string, displayname: string, roleID: string, email: string, birthday: string, phoneNumber: string) {\r\n        this.Username = username\r\n        this.Password = password\r\n        this.DisplayName = displayname\r\n        this.RoleId = roleID\r\n        this.Email = email\r\n        this.Birthday = birthday\r\n        this.PhoneNumber = phoneNumber\r\n    }\r\n}","import { HttpClient } from '@angular/common/http';\r\nimport { Injectable } from '@angular/core';\r\nimport { Observable } from 'rxjs';\r\nimport { environment } from '../../../../environments/environment';\r\nimport { UserModel } from '../../../shared/models/user.model';\r\n\r\nclass ChangePasswordModel {\r\n  \r\n  Password: string\r\n  constructor(password: string) {\r\n      this.Password = password\r\n  }\r\n}\r\n@Injectable({providedIn: 'root'})\r\nexport class DoiMatKhauService {\r\n    constructor(private httpClient: HttpClient) {}\r\n    checkOldPassword(password: string): Observable<any> {\r\n      \r\n      let url = environment.api.url + 'User/checkPassword';\r\n      return this.httpClient.post(url, new ChangePasswordModel(password));\r\n    }\r\n      changePassword(user: UserModel): Observable<any> {\r\n        let url = environment.api.url + 'User/changePassword';\r\n        return this.httpClient.post(url, user);\r\n      }\r\n}","import { Component, OnInit, Inject } from '@angular/core';\r\nimport {\r\n  MatDialogRef,\r\n  MAT_DIALOG_DATA,\r\n  MatDialog,\r\n} from '@angular/material/dialog';\r\nimport { DoiMatKhauService } from './doi-mat-khau.service';\r\nimport { AlertDialogComponent } from '../../../shared/pages/alert-dialog/alert-dialog.component';\r\nimport { MatSnackBar } from '@angular/material/snack-bar';\r\nimport { UserModel } from '../../../shared/models/user.model';\r\nimport { MatDatepickerInputEvent } from '@angular/material/datepicker';\r\nimport { DatePipe } from '@angular/common';\r\nimport { FormControl } from '@angular/forms';\r\nimport { environment } from 'src/environments/environment';\r\nimport { Router } from '@angular/router';\r\n@Component({\r\n  selector: 'app-doi-mat-khau',\r\n  templateUrl: './doi-mat-khau.component.html',\r\n  styleUrls: ['./doi-mat-khau.component.scss'],\r\n})\r\nexport class DoiMatKhauComponent implements OnInit {\r\n  _user = new UserModel('', '', '', '', '', '', '');\r\n  showProgressBar = false;\r\n  __oldPassword = '';\r\n  constructor(\r\n    @Inject(MAT_DIALOG_DATA) public data: any,\r\n    public dialogMainRef: MatDialogRef<DoiMatKhauComponent>,\r\n    private __service: DoiMatKhauService,\r\n    private _alertDialog: MatDialog,\r\n    private __snackbar: MatSnackBar,\r\n    public datepipe: DatePipe,\r\n    private __router: Router\r\n  ) {}\r\n  _title = 'Thêm tài khoản';\r\n  _titleMainButton = 'Thêm';\r\n  __isClient = false\r\n  inputBirthday = new FormControl(new Date());\r\n  ngOnInit(): void {\r\n    if (this.data)\r\n      if (this.data.user) {\r\n        this._title = 'Đổi mật khẩu';\r\n        this._titleMainButton = 'Cập nhật';\r\n        this._user = this.data.user;\r\n        this._user.Password = '';\r\n        this._user.PasswordConfirm = '';\r\n        this.inputBirthday = new FormControl(new Date(this._user.Birthday));\r\n      }\r\n      if (this.data.isClient) this.__isClient = this.data.isClient;\r\n  }\r\n\r\n  startUpdate() {\r\n    this.showProgressBar = true;\r\n    this.__service.changePassword(this._user).subscribe(\r\n      (data) => {\r\n        this.showProgressBar = false;\r\n        if (data === 'true') {\r\n          this.__snackbar.open('Cập nhật thành công', null, {\r\n            duration: 2000,\r\n          });\r\n          this.dialogMainRef.close({\r\n            data: this._user,\r\n            result: true,\r\n          });\r\n        } else {\r\n          this.__snackbar.open(data.Message, null, {\r\n            duration: 2000,\r\n          });\r\n        }\r\n      },\r\n      (error) => {\r\n        this.dialogMainRef.close({\r\n          result: false,\r\n        });\r\n        this.showLogin();\r\n        this.__snackbar.open(environment.message.TOKEN_EXPIRED, null, {\r\n          duration: 2000,\r\n        });\r\n      }\r\n    );\r\n  }\r\n\r\n  update() {\r\n    //check old password\r\n    if (\r\n      this._user.Username == '' ||\r\n      this._user.Password == '' ||\r\n      this._user.PasswordConfirm == '' ||\r\n      this._user.DisplayName == '' ||\r\n      this._user.RoleId == ''\r\n    ) {\r\n      this.__snackbar.open('Vui lòng nhập đủ thông tin', null, {\r\n        duration: 2000,\r\n      });\r\n    } else if (this._user.Password != this._user.PasswordConfirm) {\r\n      this.__snackbar.open('Mật khẩu không khớp', null, {\r\n        duration: 2000,\r\n      });\r\n    } else {\r\n      var dialogRef = this._alertDialog.open(AlertDialogComponent, {\r\n        disableClose: true,\r\n        width: '17rem',\r\n        data: {\r\n          dataKey: 'Bạn có chắc muốn đổi mật khẩu?',\r\n          isConfirm: true,\r\n        },\r\n      });\r\n      dialogRef.afterClosed().subscribe((res) => {\r\n        if (res) {\r\n          this.showProgressBar = true;\r\n          this.__service.checkOldPassword(this.__oldPassword).subscribe(\r\n            (data) => {\r\n              if (data === 'true') {\r\n                this.startUpdate();\r\n              } else {\r\n                this.showProgressBar = false;\r\n                this.__snackbar.open('Mật khẩu cũ không chính xác', null, {\r\n                  duration: 2000,\r\n                });\r\n              }\r\n            },\r\n            (error) => {\r\n              this.dialogMainRef.close({\r\n                data: this._user,\r\n                result: false,\r\n              });\r\n              this.showLogin();\r\n              this.__snackbar.open(environment.message.TOKEN_EXPIRED, null, {\r\n                duration: 2000,\r\n              });\r\n            }\r\n          );\r\n        }\r\n      });\r\n    }\r\n  }\r\n  showLogin() {\r\n    if (this.__isClient) this.__router.navigate(['login']);\r\n    else this.__router.navigate(['admin/login']);\r\n  }\r\n  addEventNgaySinhChange(type: string, event: MatDatepickerInputEvent<Date>) {\r\n    this._user.Birthday = this.datepipe.transform(event.value, 'yyyy-MM-dd');\r\n  }\r\n  cancel() {\r\n    var dialogRef = this._alertDialog.open(AlertDialogComponent, {\r\n      disableClose: true,\r\n      width: '17rem',\r\n      data: {\r\n        dataKey: 'Thay đổi của bạn sẽ không được lưu. Bạn có muốn hủy?',\r\n        isConfirm: true,\r\n      },\r\n    });\r\n    dialogRef.afterClosed().subscribe((res) => {\r\n      if (res) {\r\n        this.dialogMainRef.close({\r\n          data: this._user,\r\n          result: false,\r\n        });\r\n      }\r\n    });\r\n  }\r\n}\r\n","<mat-progress-bar\r\n  mode=\"indeterminate\"\r\n  [style.display]=\"showProgressBar ? 'block' : 'none'\"\r\n></mat-progress-bar>\r\n<h2 mat-dialog-title>{{ _title }}</h2>\r\n<mat-dialog-content class=\"mat-typography\">\r\n  <p>\r\n    <mat-form-field appearance=\"outline\">\r\n      <mat-label>Mật khẩu cũ</mat-label>\r\n      <input\r\n        matInput\r\n        type=\"password\"\r\n        placeholder=\"Nhập mật khẩu cũ\"\r\n        [(ngModel)]=\"this.__oldPassword\"\r\n        required\r\n      />\r\n    </mat-form-field>\r\n    <mat-form-field appearance=\"outline\">\r\n      <mat-label>Mật khẩu mới</mat-label>\r\n      <input\r\n        matInput\r\n        type=\"password\"\r\n        placeholder=\"Nhập mật khẩu mới\"\r\n        [(ngModel)]=\"_user.Password\"\r\n        required\r\n      />\r\n    </mat-form-field>\r\n    <mat-form-field appearance=\"outline\">\r\n      <mat-label>Xác nhận mật khẩu</mat-label>\r\n      <input\r\n        matInput\r\n        type=\"password\"\r\n        placeholder=\"Nhập lại mật khẩu mới\"\r\n        [(ngModel)]=\"_user.PasswordConfirm\"\r\n        required\r\n      />\r\n    </mat-form-field>\r\n  </p>\r\n</mat-dialog-content>\r\n<mat-dialog-actions align=\"end\">\r\n  <button mat-raised-button color=\"primary\" (click)=\"update()\">\r\n    {{ _titleMainButton }}\r\n  </button>\r\n  <button mat-button cdkFocusInitial (click)=\"cancel()\">Đóng</button>\r\n</mat-dialog-actions>\r\n"],"sourceRoot":"webpack:///"}